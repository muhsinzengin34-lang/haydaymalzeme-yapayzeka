<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Hayday Chatbot</title>
    <link rel="stylesheet" href="admin.css">
    <script>
        // Browser extension hatalarÄ±nÄ± tamamen engelle
        window.addEventListener('error', (e) => {
            if (e.message && (e.message.includes('extension') || e.message.includes('Receiving end') || e.message.includes('establish connection') || e.message.includes('chrome-extension'))) {
                e.stopImmediatePropagation();
                e.preventDefault();
                return true;
            }
        }, true);
        
        window.addEventListener('unhandledrejection', (e) => {
            if (e.reason) {
                const msg = e.reason.message || e.reason.toString();
                if (msg.includes('establish connection') || msg.includes('Receiving end') || msg.includes('extension')) {
                    e.stopImmediatePropagation();
                    e.preventDefault();
                    return true;
                }
            }
        }, true);
        
        // Console hatalarÄ±nÄ± filtrele
        const originalError = console.error;
        console.error = function(...args) {
            const msg = args.join(' ');
            if (msg.includes('establish connection') || msg.includes('Receiving end') || msg.includes('extension')) return;
            originalError.apply(console, args);
        };
        
        // Chrome runtime hatalarÄ±nÄ± engelle
        if (window.chrome && chrome.runtime) {
            const originalSendMessage = chrome.runtime.sendMessage;
            chrome.runtime.sendMessage = function(...args) {
                try {
                    return originalSendMessage.apply(this, args);
                } catch (e) {
                    return Promise.resolve();
                }
            };
        }
    </script>
</head>
<body>
    <!-- Login Modal -->
    <div id="login-modal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:10000;">
        <div style="background:white;padding:40px;border-radius:12px;max-width:400px;width:90%;box-shadow:0 10px 40px rgba(0,0,0,0.3);">
            <h2 style="text-align:center;color:#667eea;margin-bottom:30px;">ğŸ” Admin GiriÅŸi</h2>
            
            <div id="send-code-step">
                <p style="text-align:center;color:#666;margin-bottom:20px;">Telegram'a giriÅŸ kodu gÃ¶nderilecek</p>
                <button class="btn" onclick="sendLoginCode()" style="width:100%;padding:15px;font-size:16px;">ğŸ“¨ Kod GÃ¶nder</button>
            </div>
            
            <div id="verify-code-step" style="display:none;">
                <p style="text-align:center;color:#666;margin-bottom:20px;">Telegram'dan gelen kodu girin</p>
                <input type="text" id="login-code" placeholder="6 haneli kod" maxlength="6" style="width:100%;padding:15px;font-size:18px;text-align:center;letter-spacing:5px;border:2px solid #e0e0e0;border-radius:8px;margin-bottom:15px;">
                <button class="btn" onclick="verifyLoginCode()" style="width:100%;padding:15px;font-size:16px;">âœ… DoÄŸrula</button>
                <button class="btn" onclick="backToSendCode()" style="width:100%;padding:10px;font-size:14px;background:#999;margin-top:10px;">â† Geri</button>
            </div>
            
            <div id="login-error" style="display:none;background:#ffebee;color:#c62828;padding:10px;border-radius:4px;margin-top:15px;text-align:center;"></div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>ğŸŒ¾ Hayday Admin Panel</h1>
        </header>
        
        <div class="tabs">
            <button class="tab active" data-tab="qa" onclick="showTab('qa')">ğŸ“š Q&A</button>
            <button class="tab" data-tab="messages" onclick="showTab('messages')">ğŸ’¬ Mesajlar</button>
            <button class="tab" data-tab="stats" onclick="showTab('stats')">ğŸ“Š Ä°statistik</button>
            <button class="tab" data-tab="cost" onclick="showTab('cost')">ğŸ’° Maliyet</button>
            <button class="tab" data-tab="performance" onclick="showTab('performance')">ğŸ¯ Performans</button>
            <button class="tab" data-tab="backup" onclick="showTab('backup')">ğŸ”„ Yedek</button>
            <button class="tab" data-tab="ai-learning" onclick="showTab('ai-learning')">ğŸ§  AI Ã–ÄŸrenme</button>
            <button class="tab" data-tab="test" onclick="showTab('test')">ğŸ§ª Test</button>
            <button class="tab" data-tab="settings" onclick="showTab('settings')">âš™ï¸ Ayarlar</button>
        </div>

        <div id="qa-tab" class="content">
            <h2>Bilgi BankasÄ±</h2>
            
            <div class="form-group">
                <label>ID (otomatik oluÅŸturulur):</label>
                <input type="text" id="qa-id" placeholder="kb.custom.v1" readonly style="background:#f5f5f5;">
            </div>
            
            <div class="form-group">
                <label>Ana Soru:</label>
                <input type="text" id="main-question" placeholder="ÃœrÃ¼n fiyat listesi ve Ã¼cretler">
            </div>
            
            <div class="form-group">
                <label>Alternatif Sorular (virgÃ¼lle ayÄ±rÄ±n):</label>
                <textarea id="questions" rows="3" placeholder="fiyat listesi nedir, Ã¼rÃ¼n fiyatlarÄ± neler, kaÃ§ para, ne kadar"></textarea>
            </div>
            
            <div class="form-group">
                <label>Anahtar Kelimeler (virgÃ¼lle ayÄ±rÄ±n):</label>
                <textarea id="keywords" rows="2" placeholder="fiyat, fiyatÄ±, Ã¼cret, kaÃ§ tl, ne kadar"></textarea>
            </div>
            
            <div class="form-group">
                <label>Cevap:</label>
                <textarea id="answer" rows="6" placeholder="CevabÄ±nÄ±zÄ± yazÄ±n..."></textarea>
            </div>
            
            <div class="form-group">
                <label>Kategori:</label>
                <input type="text" id="category" placeholder="pricing, greeting, delivery, vb.">
            </div>
            
            <div class="form-actions">
                <button class="btn" onclick="addQA()">â• Ekle</button>
                <button class="btn" onclick="clearForm()" style="background:#999;">ğŸ—‘ï¸ Temizle</button>
            </div>
            
            <div class="qa-list">
                <h3 style="margin-top: 30px; color: #667eea;">Mevcut Q&A Listesi</h3>
                
                <div style="margin:15px 0;display:flex;gap:10px;flex-wrap:wrap;">
                    <input type="text" id="qa-search" placeholder="ğŸ” Ara..." style="flex:1;min-width:200px;padding:10px;border:2px solid #e0e0e0;border-radius:8px;">
                    <button class="btn" onclick="exportQA()" style="width:auto;">ğŸ“¥ DÄ±ÅŸa Aktar</button>
                    <button class="btn" onclick="document.getElementById('import-file').click()" style="width:auto;background:#764ba2;">ğŸ“¤ Ä°Ã§e Aktar</button>
                    <input type="file" id="import-file" accept=".json" style="display:none;" onchange="importQA(event)">
                </div>
                
                <div id="qa-list"></div>
            </div>
        </div>

        <div id="messages-tab" class="content hidden">
            <h2>ğŸ’¬ KullanÄ±cÄ± MesajlarÄ±</h2>
            
            <div class="stats-wrapper">
                <div class="stats-grid">
                <div class="stat-card">
                    <h3>Aktif Sohbetler</h3>
                    <div class="stat-value" id="active-chats">0</div>
                </div>
                <div class="stat-card">
                    <h3>Bekleyen Mesajlar</h3>
                    <div class="stat-value" id="pending-messages">0</div>
                </div>
                <div class="stat-card">
                    <h3>BugÃ¼n Toplam</h3>
                    <div class="stat-value" id="today-total">0</div>
                </div>
                </div>
            </div>
            
            <div style="display:flex;gap:10px;margin:15px 0;flex-wrap:wrap;">
                <input type="text" id="message-search" placeholder="ğŸ” KullanÄ±cÄ± veya mesaj ara..." style="flex:1;min-width:200px;padding:10px;border:2px solid #e0e0e0;border-radius:8px;">
                <select id="message-filter" style="padding:10px;border:2px solid #e0e0e0;border-radius:8px;">
                    <option value="all">TÃ¼m Mesajlar</option>
                    <option value="today">BugÃ¼n</option>
                    <option value="week">Bu Hafta</option>
                    <option value="month">Bu Ay</option>
                    <option value="unread">OkunmamÄ±ÅŸ</option>
                </select>
                <select id="message-status" style="padding:10px;border:2px solid #e0e0e0;border-radius:8px;">
                    <option value="all">TÃ¼m Durumlar</option>
                    <option value="active">ğŸŸ¢ Aktif</option>
                    <option value="waiting">ğŸŸ¡ Bekliyor</option>
                    <option value="closed">âš« KapalÄ±</option>
                </select>
                <button class="btn" onclick="refreshMessages()" style="width:auto;">ğŸ”„ Yenile</button>

                <button class="btn" onclick="bulkDeleteMessages()" style="width:auto;background:#F44336;">ğŸ—‘ï¸ Toplu Mesaj Sil</button>
            </div>
            
            <div style="display:grid;grid-template-columns:1fr 2fr;gap:15px;margin-top:20px;">
                <div style="background:#f5f7fa;padding:15px;border-radius:8px;max-height:600px;overflow-y:auto;">
                    <h3 style="color:#667eea;margin-bottom:15px;">Sohbet Listesi</h3>
                    <div id="chat-list">
                        <div style="text-align:center;padding:20px;color:#999;">ğŸ’¬ HenÃ¼z sohbet yok</div>
                    </div>
                </div>
                
                <div style="background:#f5f7fa;padding:15px;border-radius:8px;display:flex;flex-direction:column;max-height:600px;">
                    <div id="chat-header" style="padding:10px;background:white;border-radius:8px;margin-bottom:10px;display:none;">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <h3 style="margin:0;color:#667eea;" id="chat-user-name">KullanÄ±cÄ±</h3>
                                <small style="color:#999;" id="chat-user-info">Ã‡evrimiÃ§i</small>
                            </div>
                            <div style="display:flex;gap:5px;">
                                <button class="btn" onclick="takeOverChat()" style="padding:8px 15px;font-size:13px;">ğŸ‘¤ Devral</button>
                                <button class="btn" onclick="deleteChatMessages()" style="padding:8px 15px;font-size:13px;background:#f44336;">ğŸ—‘ï¸ Sil</button>
                                <button class="btn" onclick="closeChat()" style="padding:8px 15px;font-size:13px;background:#999;">âŒ Kapat</button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="chat-messages" style="flex:1;background:white;border-radius:8px;padding:15px;overflow-y:auto;margin-bottom:10px;">
                        <div style="text-align:center;padding:40px;color:#999;">
                            ğŸ‘ˆ Bir sohbet seÃ§in
                        </div>
                    </div>
                    
                    <div id="chat-input-area" style="display:none;">
                        <div style="display:flex;gap:10px;">
                            <input type="text" id="admin-message-input" placeholder="MesajÄ±nÄ±zÄ± yazÄ±n..." style="flex:1;padding:12px;border:2px solid #e0e0e0;border-radius:8px;" onkeypress="if(event.key==='Enter') sendAdminMessage()">
                            <button class="btn" onclick="sendAdminMessage()" style="width:auto;padding:12px 20px;">ğŸ“¤ GÃ¶nder</button>
                        </div>
                        <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap;">
                            <button class="btn" onclick="insertQuickReply('Merhaba! Size nasÄ±l yardÄ±mcÄ± olabilirim?')" style="width:auto;padding:6px 12px;font-size:12px;background:#764ba2;">ğŸ’¬ HÄ±zlÄ±: Merhaba</button>
                            <button class="btn" onclick="insertQuickReply('Fiyat listesini gÃ¶ndereceÄŸim.')" style="width:auto;padding:6px 12px;font-size:12px;background:#764ba2;">ğŸ’° HÄ±zlÄ±: Fiyat</button>
                            <button class="btn" onclick="insertQuickReply('SipariÅŸiniz alÄ±ndÄ±, teÅŸekkÃ¼rler!')" style="width:auto;padding:6px 12px;font-size:12px;background:#764ba2;">âœ… HÄ±zlÄ±: SipariÅŸ</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="cost-tab" class="content hidden">
            <h2>ğŸ’° Maliyet Takibi & Optimizasyon</h2>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                    <h3 style="color:#667eea;margin:0;">ğŸ“Š Genel BakÄ±ÅŸ</h3>
                    <button class="btn" onclick="refreshCostStats()" style="width:auto;padding:8px 15px;">ğŸ”„ Yenile</button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card" style="background:linear-gradient(135deg,#667eea,#764ba2);color:white;">
                        <h3>Toplam Maliyet</h3>
                        <div class="stat-value" id="total-cost" style="color:white;">$0.00</div>
                        <small style="opacity:0.9;">BaÅŸlangÄ±Ã§tan beri</small>
                    </div>
                    <div class="stat-card" style="background:linear-gradient(135deg,#f093fb,#f5576c);color:white;">
                        <h3>BugÃ¼n</h3>
                        <div class="stat-value" id="today-cost" style="color:white;">$0.00</div>
                        <small style="opacity:0.9;">GÃ¼nlÃ¼k maliyet</small>
                    </div>
                    <div class="stat-card" style="background:linear-gradient(135deg,#4facfe,#00f2fe);color:white;">
                        <h3>Bu Ay</h3>
                        <div class="stat-value" id="monthly-cost" style="color:white;">$0.00</div>
                        <small style="opacity:0.9;">AylÄ±k maliyet</small>
                    </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“ˆ YanÄ±t DaÄŸÄ±lÄ±mÄ± (BugÃ¼n)</h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">
                    <div style="background:white;padding:15px;border-radius:8px;border-left:4px solid #4CAF50;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Q&A YanÄ±tlar (ÃœCRETSÄ°Z)</div>
                        <div style="font-size:24px;font-weight:bold;color:#4CAF50;" id="today-qa-count">0</div>
                        <div style="font-size:12px;color:#999;margin-top:5px;" id="today-qa-percent">0%</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;border-left:4px solid #2196F3;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Cache Hits (ÃœCRETSÄ°Z)</div>
                        <div style="font-size:24px;font-weight:bold;color:#2196F3;" id="today-cache-count">0</div>
                        <div style="font-size:12px;color:#999;margin-top:5px;" id="today-cache-percent">0%</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;border-left:4px solid #f44336;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">GPT Ã‡aÄŸrÄ±larÄ± (ÃœCRETLÄ°)</div>
                        <div style="font-size:24px;font-weight:bold;color:#f44336;" id="today-gpt-count">0</div>
                        <div style="font-size:12px;color:#999;margin-top:5px;" id="today-gpt-percent">0%</div>
                    </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“Š Token KullanÄ±mÄ± (Bu Ay)</h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;">
                    <div style="background:white;padding:15px;border-radius:8px;text-align:center;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Input Tokens</div>
                        <div style="font-size:20px;font-weight:bold;color:#667eea;" id="monthly-input-tokens">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;text-align:center;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Output Tokens</div>
                        <div style="font-size:20px;font-weight:bold;color:#764ba2;" id="monthly-output-tokens">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;text-align:center;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Toplam Tokens</div>
                        <div style="font-size:20px;font-weight:bold;color:#4CAF50;" id="monthly-total-tokens">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;text-align:center;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Ortalama/Ã‡aÄŸrÄ±</div>
                        <div style="font-size:20px;font-weight:bold;color:#FF9800;" id="monthly-avg-tokens">0</div>
                    </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“… Son 30 GÃ¼n Maliyet GrafiÄŸi</h3>
                <div id="cost-chart" style="background:white;border-radius:8px;padding:20px;min-height:200px;">
                    <div style="text-align:center;color:#999;padding:40px;">YÃ¼klÃ¼yor...</div>
                </div>
            </div>
            
            <div style="background:#fff3cd;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #ffc107;">
                <h3 style="color:#856404;margin-bottom:10px;">ğŸ’¡ Optimizasyon Ã–nerileri</h3>
                <div id="optimization-tips" style="color:#856404;">
                    <p style="margin:5px 0;">â€¢ Q&A yanÄ±tlama oranÄ±nÄ± artÄ±rmak iÃ§in sÄ±k sorulan sorularÄ± Q&A'ya ekleyin</p>
                    <p style="margin:5px 0;">â€¢ Cache hit oranÄ±nÄ± artÄ±rmak iÃ§in benzer sorularÄ± standartlaÅŸtÄ±rÄ±n</p>
                    <p style="margin:5px 0;">â€¢ GPT kullanÄ±mÄ±nÄ± azaltmak iÃ§in AI Ã¶ÄŸrenme sekmesinden "Analiz Et" butonuna basÄ±n</p>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;">
                <h3 style="color:#f44336;margin-bottom:15px;">âš ï¸ Tehlikeli BÃ¶lge</h3>
                <button class="btn" onclick="resetCostData()" style="background:#f44336;width:auto;">ğŸ—‘ï¸ Maliyet Verilerini SÄ±fÄ±rla</button>
                <p style="color:#999;margin-top:10px;font-size:12px;">Dikkat: TÃ¼m maliyet geÃ§miÅŸi silinecek!</p>
            </div>
        </div>
        
        <div id="stats-tab" class="content hidden">
            <h2>Ä°statistikler</h2>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ¤– AI Durum</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>OpenAI API</h3>
                        <div class="stat-value" id="openai-status" style="font-size:24px;">â³</div>
                        <small id="openai-status-text">Kontrol ediliyor...</small>
                    </div>
                    <div class="stat-card">
                        <h3>Q&A Database</h3>
                        <div class="stat-value" id="qa-status" style="font-size:24px;">â³</div>
                        <small id="qa-status-text">Kontrol ediliyor...</small>
                    </div>
                    <div class="stat-card">
                        <h3>Telegram Bot</h3>
                        <div class="stat-value" id="telegram-status" style="font-size:24px;">â³</div>
                        <small id="telegram-status-text">Kontrol ediliyor...</small>
                    </div>
                </div>
            </div>
            
            <div class="stats-wrapper">
                <div class="stats-grid">
                <div class="stat-card">
                    <h3>Toplam Mesaj</h3>
                    <div class="stat-value" id="total-messages">0</div>
                </div>
                <div class="stat-card">
                    <h3>Aktif KullanÄ±cÄ±</h3>
                    <div class="stat-value" id="active-users">0</div>
                </div>
                <div class="stat-card">
                    <h3>BugÃ¼nkÃ¼ Mesajlar</h3>
                    <div class="stat-value" id="today-messages">0</div>
                </div>
                </div>
            </div>
            
            <div style="margin-top:30px;">
                <h3 style="color:#667eea;margin-bottom:15px;">Toplam Q&A SayÄ±sÄ±</h3>
                <div class="stat-card">
                    <div class="stat-value" id="total-qa">0</div>
                </div>
            </div>
            
            <div style="margin-top:30px;">
                <h3 style="color:#667eea;margin-bottom:15px;">En Ã‡ok Sorulan Sorular</h3>
                <div id="top-questions" style="background:#f5f7fa;padding:15px;border-radius:8px;">
                    <p style="color:#999;">Veri yÃ¼kleniyor...</p>
                </div>
            </div>
        </div>
        
        <div id="performance-tab" class="content hidden">
            <h2>ğŸ¯ Performans & Sistem SaÄŸlÄ±ÄŸÄ±</h2>
            
            <div class="stats-wrapper">
                <div class="stats-grid">
                <div class="stat-card">
                    <h3>Ortalama YanÄ±t SÃ¼resi</h3>
                    <div class="stat-value" id="avg-response-time">-</div>
                    <small id="response-time-status">HesaplanÄ±yor...</small>
                </div>
                <div class="stat-card">
                    <h3>Sistem Uptime</h3>
                    <div class="stat-value" id="system-uptime">-</div>
                    <small id="uptime-detail">YÃ¼klÃ¼yor...</small>
                </div>
                <div class="stat-card">
                    <h3>Bellek KullanÄ±mÄ±</h3>
                    <div class="stat-value" id="memory-usage">-</div>
                    <small id="memory-detail">YÃ¼klÃ¼yor...</small>
                </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-top:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">Son 24 Saat Aktivite</h3>
                <div id="activity-chart" style="background:white;border-radius:8px;padding:20px;">
                    <div style="text-align:center;color:#999;padding:40px;">YÃ¼klÃ¼yor...</div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-top:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“Š DetaylÄ± Metrikler</h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">
                    <div style="background:white;padding:15px;border-radius:8px;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">Toplam Ä°stek</div>
                        <div style="font-size:24px;font-weight:bold;color:#667eea;" id="total-requests">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">BaÅŸarÄ±lÄ± Ä°stek</div>
                        <div style="font-size:24px;font-weight:bold;color:#4CAF50;" id="success-requests">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">HatalÄ± Ä°stek</div>
                        <div style="font-size:24px;font-weight:bold;color:#f44336;" id="error-requests">0</div>
                    </div>
                    <div style="background:white;padding:15px;border-radius:8px;">
                        <div style="font-size:12px;color:#666;margin-bottom:5px;">BaÅŸarÄ± OranÄ±</div>
                        <div style="font-size:24px;font-weight:bold;color:#FF9800;" id="success-rate">0%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="backup-tab" class="content hidden">
            <h2>ğŸ”„ Yedekleme & Geri YÃ¼kleme</h2>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">Otomatik Yedekleme</h3>
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="auto-backup" checked style="width:auto;">
                        <span>Otomatik yedeklemeyi aktif et</span>
                    </label>
                </div>
                <div class="form-group">
                    <label>Yedekleme SÄ±klÄ±ÄŸÄ±:</label>
                    <select style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;">
                        <option>Her GÃ¼n</option>
                        <option>Her Hafta</option>
                        <option>Her Ay</option>
                    </select>
                </div>
                <button class="btn">ğŸ’¾ AyarlarÄ± Kaydet</button>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">Manuel Yedekleme</h3>
                <div class="form-actions">
                    <button class="btn" onclick="backupAll()">ğŸ“¥ TÃ¼m Verileri Yedekle</button>
                    <button class="btn" onclick="exportQA()" style="background:#764ba2;">ğŸ“¥ Sadece Q&A Yedekle</button>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;">
                <h3 style="color:#667eea;margin-bottom:15px;">Geri YÃ¼kleme</h3>
                <input type="file" id="restore-file" accept=".json" style="display:none;" onchange="restoreBackup(event)">
                <button class="btn" onclick="document.getElementById('restore-file').click()">ğŸ“¤ YedeÄŸi Geri YÃ¼kle</button>
                <p style="color:#999;margin-top:10px;font-size:14px;">âš ï¸ Dikkat: Mevcut veriler silinecek!</p>
            </div>
        </div>
        
        <div id="ai-learning-tab" class="content hidden">
            <h2>ğŸ§  Yapay Zeka Ã–ÄŸrenme & EÄŸitim Paneli</h2>
            
            <div class="stats-wrapper">
                <div class="stats-grid">
                <div class="stat-card">
                    <h3>EÄŸitim Verisi</h3>
                    <div class="stat-value" id="training-data-count">0</div>
                    <small>Toplam konuÅŸma</small>
                </div>
                <div class="stat-card">
                    <h3>Ã–ÄŸrenilen Paternler</h3>
                    <div class="stat-value" id="learned-patterns">0</div>
                    <small>Yeni patern</small>
                </div>
                <div class="stat-card">
                    <h3>BaÅŸarÄ± OranÄ±</h3>
                    <div class="stat-value" id="success-rate">0%</div>
                    <small>YanÄ±t doÄŸruluÄŸu</small>
                </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸš€ Otomatik EÄŸitim</h3>
                <div style="display:grid;grid-template-columns:1fr;gap:10px;">
                    <button class="btn" onclick="analyzeConversations()">ğŸ” TÃ¼m KonuÅŸmalarÄ± Analiz Et</button>
                    <button class="btn" onclick="generateQAFromChats()" style="background:#9C27B0;">âœ¨ Otomatik Q&A OluÅŸtur</button>
                    <button class="btn" onclick="learnAndCleanMessages()" style="background:#F44336;font-size:16px;padding:15px;">ğŸ§¹ Ã–ÄREN VE TEMÄ°ZLE</button>
                </div>
                <p style="color:#999;font-size:12px;margin-top:10px;">âš ï¸ "Ã–ÄŸren ve Temizle" butonu: AI tÃ¼m mesajlarÄ± analiz edip Ã¶ÄŸrenir, sonra mesajlarÄ± siler. Ã–ÄŸrenilen bilgiler kalÄ±r.</p>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“Š EÄŸitim Ä°statistikleri</h3>
                <div id="training-stats" style="background:white;padding:15px;border-radius:8px;">
                    <div style="margin-bottom:15px;">
                        <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                            <span>ğŸ’¬ En Ã‡ok Sorulan Sorular</span>
                            <span id="top-questions-count">0</span>
                        </div>
                        <div style="background:#e0e0e0;height:8px;border-radius:4px;overflow:hidden;">
                            <div id="top-questions-bar" style="background:#667eea;height:100%;width:0%;transition:width 0.3s;"></div>
                        </div>
                    </div>
                    <div style="margin-bottom:15px;">
                        <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                            <span>ğŸ¤– Bot YanÄ±t OranÄ±</span>
                            <span id="bot-response-rate">0%</span>
                        </div>
                        <div style="background:#e0e0e0;height:8px;border-radius:4px;overflow:hidden;">
                            <div id="bot-response-bar" style="background:#4CAF50;height:100%;width:0%;transition:width 0.3s;"></div>
                        </div>
                    </div>
                    <div style="margin-bottom:15px;">
                        <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                            <span>ğŸ§  AI YanÄ±t OranÄ±</span>
                            <span id="ai-response-rate">0%</span>
                        </div>
                        <div style="background:#e0e0e0;height:8px;border-radius:4px;overflow:hidden;">
                            <div id="ai-response-bar" style="background:#9C27B0;height:100%;width:0%;transition:width 0.3s;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                            <span>ğŸ‘¤ Admin MÃ¼dahale OranÄ±</span>
                            <span id="admin-intervention-rate">0%</span>
                        </div>
                        <div style="background:#e0e0e0;height:8px;border-radius:4px;overflow:hidden;">
                            <div id="admin-intervention-bar" style="background:#FF9800;height:100%;width:0%;transition:width 0.3s;"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“ˆ Ã–ÄŸrenilen Yeni Paternler</h3>
                <div id="learned-patterns-list" style="background:white;padding:15px;border-radius:8px;max-height:300px;overflow-y:auto;">
                    <div style="text-align:center;color:#999;padding:20px;">HenÃ¼z patern analizi yapÄ±lmadÄ±</div>
                </div>
            </div>
            

            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ› ï¸ EÄŸitim AyarlarÄ±</h3>
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="auto-learning" checked style="width:auto;">
                        <span>Otomatik Ã¶ÄŸrenmeyi aktif et</span>
                    </label>
                    <small style="color:#666;display:block;margin-top:5px;">Her yeni konuÅŸmadan otomatik Ã¶ÄŸren</small>
                </div>
                <div class="form-group">
                    <label>Minimum GÃ¼ven Skoru (Q&A oluÅŸturma iÃ§in):</label>
                    <input type="range" id="confidence-threshold" min="0.5" max="1" step="0.05" value="0.8" style="width:100%;">
                    <div style="display:flex;justify-content:space-between;font-size:12px;color:#666;">
                        <span>DÃ¼ÅŸÃ¼k (0.5)</span>
                        <span id="confidence-value">0.8</span>
                        <span>YÃ¼ksek (1.0)</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>EÄŸitim SÄ±klÄ±ÄŸÄ±:</label>
                    <select id="training-frequency" style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;">
                        <option value="realtime">GerÃ§ek ZamanlÄ±</option>
                        <option value="hourly">Saatlik</option>
                        <option value="daily" selected>GÃ¼nlÃ¼k</option>
                        <option value="weekly">HaftalÄ±k</option>
                        <option value="manual">Manuel</option>
                    </select>
                </div>
                <button class="btn" onclick="saveAISettings()">ğŸ’¾ AyarlarÄ± Kaydet</button>
            </div>
        </div>
        
        <div id="test-tab" class="content hidden">
            <h2>ğŸ§ª Sistem Test Paneli</h2>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸš€ HÄ±zlÄ± Test</h3>
                <button class="btn" onclick="runAllTests()" style="width:100%;font-size:18px;padding:20px;">âš¡ TÃœM TESTLERÄ° Ã‡ALIÅTIR</button>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ” Bireysel Testler</h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:8px;">
                    <button class="btn" onclick="testAPI()" style="background:#4CAF50;padding:12px;font-size:13px;">ğŸ¯ API</button>
                    <button class="btn" onclick="testDatabase()" style="background:#2196F3;padding:12px;font-size:13px;">ğŸ’¾ DB</button>
                    <button class="btn" onclick="testDBMigration()" style="background:#3F51B5;padding:12px;font-size:13px;">ğŸ”„ DB Migration</button>
                    <button class="btn" onclick="testSocket()" style="background:#FF9800;padding:12px;font-size:13px;">ğŸ”Œ Socket</button>
                    <button class="btn" onclick="testQA()" style="background:#9C27B0;padding:12px;font-size:13px;">ğŸ“š Q&A</button>
                    <button class="btn" onclick="testChat()" style="background:#00BCD4;padding:12px;font-size:13px;">ğŸ’¬ Chat</button>
                    <button class="btn" onclick="testAdmin()" style="background:#E91E63;padding:12px;font-size:13px;">ğŸ‘¤ Admin</button>
                    <button class="btn" onclick="testAILearning()" style="background:#673AB7;padding:12px;font-size:13px;">ğŸ§  AI Ã–ÄŸrenme</button>
                    <button class="btn" onclick="testSecurity()" style="background:#F44336;padding:12px;font-size:13px;">ğŸ”’ GÃ¼venlik</button>
                    <button class="btn" onclick="testPerformance()" style="background:#009688;padding:12px;font-size:13px;">âš¡ Performans</button>
                    <button class="btn" onclick="testOpenAI()" style="background:#10A37F;padding:12px;font-size:13px;">ğŸ¤– OpenAI</button>
                    <button class="btn" onclick="testAIModes()" style="background:#7C3AED;padding:12px;font-size:13px;">ğŸ­ AI Modes</button>
                    <button class="btn" onclick="testAIDestek()" style="background:#2196F3;padding:12px;font-size:13px;">ğŸ’¬ AI-DESTEK</button>
                    <button class="btn" onclick="testAISatis()" style="background:#4CAF50;padding:12px;font-size:13px;">ğŸ’° AI-SATIÅ</button>
                    <button class="btn" onclick="testAIRouter()" style="background:#FF5722;padding:12px;font-size:13px;">ğŸ§­ AI Router</button>
                    <button class="btn" onclick="testFileSystem()" style="background:#795548;padding:12px;font-size:13px;">ğŸ“ File System</button>
                    <button class="btn" onclick="testTelegram()" style="background:#0088cc;padding:12px;font-size:13px;">ğŸ“¨ Telegram</button>
                    <button class="btn" onclick="testEnv()" style="background:#607D8B;padding:12px;font-size:13px;">ğŸ” ENV</button>
                    <button class="btn" onclick="testAPIKeys()" style="background:#F44336;padding:12px;font-size:13px;">ğŸ”‘ API Keys</button>
                    <button class="btn" onclick="testBackup()" style="background:#009688;padding:12px;font-size:13px;">ğŸ’¾ Backup</button>
                    <button class="btn" onclick="testSettings()" style="background:#9E9E9E;padding:12px;font-size:13px;">âš™ï¸ Settings</button>
                    <button class="btn" onclick="testCostTracking()" style="background:#4CAF50;padding:12px;font-size:13px;">ğŸ’° Maliyet</button>
                    <button class="btn" onclick="testCostOptimization()" style="background:#FF9800;padding:12px;font-size:13px;">ğŸ“Š Optimizasyon</button>
                    <button class="btn" onclick="testIndexPage()" style="background:#00BCD4;padding:12px;font-size:13px;">ğŸ  Index</button>
                    <button class="btn" onclick="testChatbotHealth()" style="background:#8BC34A;padding:12px;font-size:13px;">ğŸ¤– Chatbot</button>
                    <button class="btn" onclick="testWidgetLoad()" style="background:#FFC107;padding:12px;font-size:13px;">ğŸ’¬ Widget</button>
                    <button class="btn" onclick="testMessageFlow()" style="background:#03A9F4;padding:12px;font-size:13px;">ğŸ“¨ Mesaj</button>
                </div>
            </div>
            

            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ¥ SaÄŸlÄ±k Kontrolleri</h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;">
                    <button class="btn" onclick="testIndexHealth()" style="background:#00BCD4;padding:10px;font-size:13px;">ğŸ  Index</button>
                    <button class="btn" onclick="testChatbotSystem()" style="background:#8BC34A;padding:10px;font-size:13px;">ğŸ¤– Chatbot</button>
                    <button class="btn" onclick="testAISystem()" style="background:#9C27B0;padding:10px;font-size:13px;">ğŸ§  AI</button>
                    <button class="btn" onclick="testAdminPanel()" style="background:#E91E63;padding:10px;font-size:13px;">ğŸ‘¨ğŸ’¼ Admin</button>
                </div>
            </div>

            <div style="background:#f5f7fa;padding:15px;border-radius:8px;">
                <h3 style="color:#667eea;margin-bottom:15px;">ğŸ“Š Test SonuÃ§larÄ±</h3>
                <div id="test-results" style="background:white;padding:15px;border-radius:8px;min-height:300px;max-height:500px;overflow-y:auto;font-family:monospace;font-size:13px;">
                    <div style="color:#999;text-align:center;padding:40px;">Test sonuÃ§larÄ± burada gÃ¶rÃ¼ntÃ¼lenecek...</div>
                </div>
                <button class="btn" onclick="clearTestResults()" style="background:#999;margin-top:10px;">ğŸ—‘ï¸ SonuÃ§larÄ± Temizle</button>
            </div>
        </div>
        


        <div id="settings-tab" class="content hidden">
            <h2>Bot AyarlarÄ±</h2>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ¤– Sistem AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label>Sistem Durumu:</label>
                    <select id="bot-status" style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:15px;">
                        <option value="active">âœ… Aktif</option>
                        <option value="inactive">âŒ Pasif</option>
                        <option value="maintenance">ğŸ”§ BakÄ±mda</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Bot Dili:</label>
                    <select id="bot-language" style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:15px;">
                        <option value="tr">ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e</option>
                        <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                    </select>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #667eea;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ¤– AI Asistan AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="ai-enabled" checked style="width:auto;">
                        <span>AI AsistanÄ± Aktif Et</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Bot AdÄ±:</label>
                    <input type="text" id="ai-name" placeholder="Hay Day Asistan" value="Hay Day Asistan">
                </div>
                
                <div class="form-group">
                    <label>KarÅŸÄ±lama MesajÄ±:</label>
                    <textarea id="ai-welcome" rows="2" placeholder="Merhaba! Size nasÄ±l yardÄ±mcÄ± olabilirim?">Merhaba! ğŸŒ¾ Hay Day malzeme satÄ±ÅŸÄ± iÃ§in buradayÄ±m. Size nasÄ±l yardÄ±mcÄ± olabilirim?</textarea>
                </div>
                
                <div class="form-group">
                    <label>VarsayÄ±lan YanÄ±t:</label>
                    <textarea id="ai-default" rows="2" placeholder="ÃœzgÃ¼nÃ¼m, bu konuda yardÄ±mcÄ± olamadÄ±m.">ÃœzgÃ¼nÃ¼m, bu konuda size yardÄ±mcÄ± olamÄ±yorum. Fiyat listesi, Ã¼rÃ¼nler veya teslimat hakkÄ±nda soru sorabilirsiniz.</textarea>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ’¬ Sistem MesajlarÄ±</h3>
                
                <div class="form-group">
                    <label>Ã‡evrimdÄ±ÅŸÄ± MesajÄ±:</label>
                    <textarea id="offline-message" rows="2" placeholder="Åu anda Ã§evrimdÄ±ÅŸÄ±yÄ±z. LÃ¼tfen daha sonra tekrar deneyin.">Åu anda Ã§evrimdÄ±ÅŸÄ±yÄ±z. LÃ¼tfen daha sonra tekrar deneyin.</textarea>
                </div>
                
                <div class="form-group">
                    <label>BakÄ±m MesajÄ±:</label>
                    <textarea id="maintenance-message" rows="2" placeholder="Bot bakÄ±mdadÄ±r. KÄ±sa sÃ¼re sonra tekrar deneyin.">Sistem bakÄ±mdadÄ±r. KÄ±sa sÃ¼re sonra tekrar deneyin. ğŸ”§</textarea>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">â±ï¸ YanÄ±t SÃ¼releri</h3>
                
                <div class="form-group">
                    <label>Yazma Animasyonu SÃ¼resi (saniye):</label>
                    <input type="number" id="typing-delay" min="0" max="5" step="0.5" value="1.5" placeholder="1.5">
                    <small style="color:#999;">Bot yanÄ±t vermeden Ã¶nce "yazÄ±yor..." gÃ¶sterme sÃ¼resi</small>
                </div>
                
                <div class="form-group">
                    <label>Otomatik YanÄ±t Gecikme (saniye):</label>
                    <input type="number" id="response-delay" min="0" max="10" step="0.5" value="0.5" placeholder="0.5">
                    <small style="color:#999;">Mesaj alÄ±ndÄ±ktan sonra yanÄ±t verme sÃ¼resi</small>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ”’ GÃ¼venlik AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label>Maksimum Mesaj UzunluÄŸu (karakter):</label>
                    <input type="number" id="max-message-length" min="100" max="5000" value="800" placeholder="800">
                </div>
                
                <div class="form-group">
                    <label>Spam KorumasÄ± (saniye baÅŸÄ±na mesaj):</label>
                    <input type="number" id="spam-limit" min="1" max="10" value="3" placeholder="3">
                    <small style="color:#999;">KullanÄ±cÄ±nÄ±n saniyede gÃ¶nderebileceÄŸi maksimum mesaj sayÄ±sÄ±</small>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="block-links" style="width:auto;">
                        <span>Link gÃ¶nderimini engelle</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="profanity-filter" style="width:auto;">
                        <span>KÃ¼fÃ¼r filtresini aktif et</span>
                    </label>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ¨ GÃ¶rÃ¼nÃ¼m AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label>Widget Pozisyonu:</label>
                    <select id="widget-position" style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:15px;">
                        <option value="bottom-right">SaÄŸ Alt</option>
                        <option value="bottom-left">Sol Alt</option>
                        <option value="top-right">SaÄŸ Ãœst</option>
                        <option value="top-left">Sol Ãœst</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Widget Renk TemasÄ±:</label>
                    <select id="widget-theme" style="width:100%;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:15px;">
                        <option value="green">ğŸ’š YeÅŸil (VarsayÄ±lan)</option>
                        <option value="blue">ğŸ’™ Mavi</option>
                        <option value="purple">ğŸ’œ Mor</option>
                        <option value="red">â¤ï¸ KÄ±rmÄ±zÄ±</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="show-avatar" checked style="width:auto;">
                        <span>Bot avatarÄ±nÄ± gÃ¶ster</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="show-timestamp" checked style="width:auto;">
                        <span>Mesaj zaman damgasÄ±nÄ± gÃ¶ster</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="sound-enabled" checked style="width:auto;">
                        <span>Bildirim sesini aktif et</span>
                    </label>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ“Š Analitik AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="track-users" checked style="width:auto;">
                        <span>KullanÄ±cÄ± takibini aktif et</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="save-history" checked style="width:auto;">
                        <span>Sohbet geÃ§miÅŸini kaydet</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>GeÃ§miÅŸ Saklama SÃ¼resi (gÃ¼n):</label>
                    <input type="number" id="history-retention" min="1" max="365" value="30" placeholder="30">
                    <small style="color:#999;">Sohbet geÃ§miÅŸinin kaÃ§ gÃ¼n saklanacaÄŸÄ±</small>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;border-left:4px solid #F44336;">
                <h3 style="color:#F44336;margin-bottom:15px;font-size:16px;">ğŸ” API Keys & Tokens</h3>
                
                <div class="form-group">
                    <label>OpenAI API Key:</label>
                    <div style="display:flex;gap:10px;">
                        <input type="password" id="openai-api-key" placeholder="sk-proj-..." style="flex:1;">
                        <button class="btn" onclick="toggleKeyVisibility('openai-api-key')" style="width:auto;padding:8px 15px;">ğŸ‘ï¸</button>
                    </div>
                    <small style="color:#666;display:block;margin-top:5px;">OpenAI GPT-3.5/4 iÃ§in gerekli</small>
                </div>
                
                <div class="form-group">
                    <label>Telegram Bot Token:</label>
                    <div style="display:flex;gap:10px;">
                        <input type="password" id="telegram-bot-token" placeholder="1234567890:ABC..." style="flex:1;">
                        <button class="btn" onclick="toggleKeyVisibility('telegram-bot-token')" style="width:auto;padding:8px 15px;">ğŸ‘ï¸</button>
                    </div>
                    <small style="color:#666;display:block;margin-top:5px;">Telegram bildirimleri iÃ§in</small>
                </div>
                
                <div class="form-group">
                    <label>Admin Telegram ID:</label>
                    <input type="text" id="admin-telegram-id" placeholder="123456789">
                    <small style="color:#666;display:block;margin-top:5px;">Telegram kullanÄ±cÄ± ID'niz</small>
                </div>
                
                <div class="form-actions">
                    <button class="btn" onclick="saveAPIKeys()" style="background:#F44336;">ğŸ” API Keys Kaydet</button>
                    <button class="btn" onclick="testAPIKeysSettings()" style="background:#2196F3;">ğŸ§ª Test Et</button>
                </div>
                
                <div style="background:#fff3cd;padding:10px;border-radius:4px;margin-top:15px;border-left:4px solid #ffc107;">
                    <strong>âš ï¸ GÃœVENLÄ°K UYARISI:</strong>
                    <p style="margin:5px 0 0 0;font-size:12px;color:#856404;">
API keyler .env dosyasÄ±nda saklanÄ±r. Sunucuyu yeniden baÅŸlatmanÄ±z gerekir.</p>
                </div>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-bottom:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ”” Bildirim AyarlarÄ±</h3>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="telegram-notifications" checked style="width:auto;">
                        <span>Telegram bildirimlerini aktif et</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label style="display:flex;align-items:center;gap:10px;">
                        <input type="checkbox" id="email-notifications" style="width:auto;">
                        <span>E-posta bildirimlerini aktif et</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Bildirim E-posta Adresi:</label>
                    <input type="email" id="notification-email" placeholder="admin@example.com">
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn" onclick="saveSettings()">ğŸ’¾ TÃ¼m AyarlarÄ± Kaydet</button>
                <button class="btn" onclick="resetSettings()" style="background:#999;">ğŸ”„ VarsayÄ±lana SÄ±fÄ±rla</button>
                <button class="btn" onclick="exportSettings()" style="background:#764ba2;">ğŸ“¥ AyarlarÄ± DÄ±ÅŸa Aktar</button>
            </div>
            
            <div style="background:#f5f7fa;padding:15px;border-radius:8px;margin-top:20px;">
                <h3 style="color:#667eea;margin-bottom:15px;font-size:16px;">ğŸ¤– AI Sistem Prompt</h3>
                
                <div class="form-group">
                    <label>AI Sistem Prompt:</label>
                    <textarea id="ai-system-prompt" rows="10" placeholder="AI iÃ§in sistem prompt'u girin...">Sen Hay Day oyunu iÃ§in profesyonel bir destek ve satÄ±ÅŸ asistanÄ±sÄ±n.

GÃ¶revin:
- ÃœrÃ¼n fiyatlarÄ± ve Ã¶zellikleri hakkÄ±nda bilgi vermek
- SatÄ±n alma kararlarÄ±nda yardÄ±mcÄ± olmak
- Teslimat ve Ã¶deme konularÄ±nda destek saÄŸlamak
- Samimi ve yardÄ±msever bir dille iletiÅŸim kurmak

Kurallar:
- TÃ¼rkÃ§e yanÄ±t ver
- KÄ±sa ve net ol (max 5 cÃ¼mle)
- Emoji kullan: ğŸŒ¾ ğŸ’° ğŸš€ ğŸ‘ âš¡
- SayÄ±larla konuÅŸ</textarea>
                    <small style="color:#666;display:block;margin-top:5px;">Bu prompt tÃ¼m AI yanÄ±tlarÄ±nda kullanÄ±lÄ±r</small>
                </div>
                
                <div class="form-actions">
                    <button class="btn" onclick="saveAIPrompt()">ğŸ’¾ Prompt Kaydet</button>
                    <button class="btn" onclick="resetAIPrompt()" style="background:#999;">ğŸ”„ VarsayÄ±lana DÃ¶ndÃ¼r</button>
                    <button class="btn" onclick="testAIPrompt()" style="background:#2196F3;">ğŸ§ª Test Et</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="admin.js"></script>
    <script src="message-style-fix.js"></script>
    <script>
        // Arama fonksiyonu
        document.getElementById('qa-search')?.addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const items = document.querySelectorAll('.qa-item');
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(search) ? 'block' : 'none';
            });
        });
    </script>
</body>
</html>
